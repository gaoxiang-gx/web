webpackJsonp([39],{zYE3:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("cAgV"),s=a("cjZW"),i=a("UgCr"),l={components:{},name:"inventoryWarning",directives:{waves:n.a},data:function(){return{tableKey:0,scrollTop:0,list:null,total:null,listLoading:!1,productOptions:[],productLoading:!1,listQuery:{warehouse_id:void 0,page:1,page_size:20,sort:"-id",storage_status:void 0},warehouseOptions:[],statusOptions:[{label:"充裕",key:0},{label:"告警",key:1},{label:"断货",key:2},{label:"告警已处理",key:3}],pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]}}},methods:{handleFilter:function(){this.listQuery.page=1,this.getList()},getList:function(){var e=this;this.listLoading=!0,Object(s.d)(this.listQuery).then(function(t){e.list=t.data.data,e.listLoading=!1,e.total=t.data.total})},getWarehouseList:function(){var e=this;Object(i.q)().then(function(t){e.warehouseOptions=t.data.data})},handleSizeChange:function(e){this.listQuery.page_size=e,this.getList()},handleCurrentChange:function(e){this.listQuery.page=e,this.getList()}},created:function(){this.getList(),this.getWarehouseList()},filters:{statusFilter:function(e){return{0:"info",1:"success"}[e]},statusTranslator:function(e){return{0:"非在售",1:"在售"}[e]}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container calendar-list-container"},[a("div",{staticClass:"filter-container"},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"150px"},attrs:{clearable:"",placeholder:"状态"},on:{change:e.handleFilter},model:{value:e.listQuery.storage_status,callback:function(t){e.$set(e.listQuery,"storage_status",t)},expression:"listQuery.storage_status"}},e._l(e.statusOptions,function(e){return a("el-option",{key:e.key,attrs:{label:e.label,value:e.key}})})),e._v(" "),a("el-select",{staticClass:"filter-item",attrs:{filterable:"",clearable:"",placeholder:"仓库"},on:{change:e.handleFilter},model:{value:e.listQuery.warehouse_id,callback:function(t){e.$set(e.listQuery,"warehouse_id",t)},expression:"listQuery.warehouse_id"}},e._l(e.warehouseOptions,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),e._v(" "),a("div",{staticClass:"filter-float"},[a("el-button",{staticClass:"filter-item",attrs:{size:"small",type:"primary",icon:"el-icon-search"},on:{click:e.handleFilter}},[e._v("搜索\n      ")])],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],key:e.tableKey,staticStyle:{width:"100%"},attrs:{data:e.list,"element-loading-text":"给我一点时间",border:"",fit:"","highlight-current-row":"",stripe:""}},[a("el-table-column",{attrs:{align:"center",label:"仓库","min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.warehouse.name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"商品","min-width":"150px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.product_goods.goods_name))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"剩余库存"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.stock))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"日均消耗"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.average_cost))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"生产周期"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.product_goods.production_cycle)+"天")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"可用天数","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[0!==t.row.average_cost?a("span",[e._v(e._s(parseInt(t.row.stock/t.row.average_cost))+"天")]):a("span",[e._v(" - ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"库存状态","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[0===t.row.stock?a("el-tag",{attrs:{type:"danger"}},[e._v("已断货")]):t.row.stock/t.row.average_cost>t.row.product_goods.production_cycle||t.row.stock/t.row.average_cost===t.row.product_goods.production_cycle?a("el-tag",{attrs:{type:"success"}},[e._v("库存充裕\n        ")]):a("el-tag",{attrs:{type:"warning"}},[e._v("库存告警\n        ")])]}}])})],1),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":e.listQuery.page,"page-sizes":[10,20,30,50],"page-size":e.listQuery.page_size,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.listQuery,"page",t)}}})],1)],1)},staticRenderFns:[]},o=a("VU/8")(l,r,!1,null,null,null);t.default=o.exports}});