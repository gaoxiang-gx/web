webpackJsonp([10],{"0hOv":function(t,e,a){var n=a("T1TT");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("f51959f6",n,!0)},"2sFW":function(t,e,a){t.exports=a.p+"static/img/fe08c19c13127d29fe3d56a8d937b759.23d313b.jpg"},T1TT:function(t,e,a){var n=a("kxFB");(t.exports=a("FZ+f")(!1)).push([t.i,"\n.message_dialog {\n  height: 500px !important;\n  background: url("+n(a("2sFW"))+") no-repeat;\n  background-size: 100% 100%;\n  padding: 100px;\n}\n.location {\n  padding: 50px;\n}\n",""])},XpDY:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("BO1k"),i=a.n(n),s=a("woOf"),l=a.n(s),o=a("vMJZ"),r={components:{},name:"messageNotification",directives:{waves:a("cAgV").a},data:function(){return{scrollTop:0,tableKey:0,list:null,total:null,listLoading:!0,activeName:"importantNotifications",systemMessageSelect:!1,listQuery:{type_code:"",page:1,page_size:20},temp:{content:""},messageTitle:"",content:"",dialogTableVisible:!1}},filters:{readStatusFilter:function(t){return{0:"info",1:"success"}[t]},readStatusTranslator:function(t){return{0:"未读",1:"已读"}[t]}},created:function(){this.getNoticeList()},methods:{handleSizeChange:function(t){this.listQuery.page_size=t,this.getNoticeList()},handleCurrentChange:function(t){this.listQuery.page=t,this.getNoticeList()},handleClickTab:function(t,e){"systemMessage"===t.name?this.systemMessageSelect=!0:this.systemMessageSelect=!1,this.handleFilter()},handleFilter:function(){this.getNoticeList()},getNoticeList:function(){var t=this;this.listLoading=!0,"importantNotifications"===this.activeName?(this.listQuery.type_code="important_notice",Object(o.b)(this.listQuery).then(function(e){t.list=e.data.data,t.total=e.data.total,t.listLoading=!1})):"systemMessage"===this.activeName&&(this.listQuery.type_code="system_notice",Object(o.b)(this.listQuery).then(function(e){t.list=e.data.data,t.total=e.data.total,t.listLoading=!1}))},handleClick:function(t){this.dialogTableVisible=!0,this.temp=l()({},t)},closeMessageDialog:function(){var t=this;this.dialogTableVisible=!1,Object(o.f)({notice_id:this.temp.id}).then(function(e){0===t.temp.status&&t.$store.state.user.important_notice--,t.temp.status=1;var a=!0,n=!1,s=void 0;try{for(var l,o=i()(t.list);!(a=(l=o.next()).done);a=!0){var r=l.value;if(r.id===t.temp.id){var c=t.list.indexOf(r);t.list.splice(c,1,t.temp);break}}}catch(t){n=!0,s=t}finally{try{!a&&o.return&&o.return()}finally{if(n)throw s}}t.$notify({title:"已阅读",message:"已阅读",type:"success",duration:2e3})})}},deactivated:function(){this.scrollTop=document.documentElement.scrollTop||document.body.scrollTop},activated:function(){window.scrollTo(0,this.scrollTop)}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container calendar-list-container"},[a("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleClickTab},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"重要通知",name:"importantNotifications"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,attrs:{stripe:!0,data:t.list,"element-loading-text":"给我一点时间",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"序号",width:"65"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"link-type"},[t._v("\n              "+t._s(e.row.id)+"\n            ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"发送人",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"link-type"},[t._v("\n              "+t._s(e.row.sender.nickname)+"\n            ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"标题","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"link-type",on:{click:function(a){t.handleClick(e.row)}}},[t._v("\n              "+t._s(e.row.title)+"\n            ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"时间","wimin-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"link-type"},[t._v("\n              "+t._s(e.row.created_at)+"\n            ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"50",align:"center",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t._f("readStatusFilter")(e.row.status)}},[t._v(t._s(t._f("readStatusTranslator")(e.row.status)))])]}}])})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":t.listQuery.page,"page-sizes":[10,20,30,50],"page-size":t.listQuery.page_size,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.listQuery,"page",e)}}})],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:"系统消息",name:"systemMessage"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],key:t.tableKey,attrs:{stripe:!0,data:t.list,"element-loading-text":"给我一点时间",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"序号",width:"65"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"link-type"},[t._v("\n              "+t._s(e.row.id)+"\n            ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"发送人",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"link-type"},[t._v("\n              "+t._s(e.row.sender.nickname)+"\n            ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"标题","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"link-type",on:{click:function(a){t.handleClick(e.row)}}},[t._v("\n              "+t._s(e.row.title)+"\n            ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"时间","wimin-width":"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"link-type"},[t._v("\n              "+t._s(e.row.created_at)+"\n            ")])]}}])}),t._v(" "),a("el-table-column",{attrs:{"min-width":"50",align:"center",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-tag",{attrs:{type:t._f("readStatusFilter")(e.row.status)}},[t._v(t._s(t._f("readStatusTranslator")(e.row.status)))])]}}])})],1),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[a("el-pagination",{attrs:{background:"","current-page":t.listQuery.page,"page-sizes":[10,20,30,50],"page-size":t.listQuery.page_size,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.$set(t.listQuery,"page",e)}}})],1)],1)],1),t._v(" "),a("el-dialog",{attrs:{"custom-class":"message_dialog",visible:t.dialogTableVisible},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("p",[t._v(t._s(t.temp.content))]),t._v(" "),a("div",{staticClass:"dialog-footer location",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:t.closeMessageDialog}},[t._v("已阅读")])],1)])],1)},staticRenderFns:[]},u=a("VU/8")(r,c,!1,function(t){a("0hOv")},null,null);e.default=u.exports}});