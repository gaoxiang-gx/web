webpackJsonp([19],{"587+":function(n,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=e("GGGG"),i=e("qsHl"),a={name:"productCost",components:{},directives:{waves:e("cAgV").a},data:function(){return{arry:[],scrollTop:0,tableKey:0,list:[],total:null,listLoading:!0,listQuery:{product_good_id:void 0,show_terminal:0,page_size:20,page:1,sort:"-id"},rules:{product_good_id:[{required:!0,message:"选择商品",trigger:"change"}],money:[{validator:function(n,t,e){t||e(new Error("输入消费")),/^\d+(\.\d+)?$/.test(t)?e():e(new Error("只能输入数字"))},trigger:"change"}]},sortOptions:[{label:"按ID升序列",key:"+id"},{label:"按ID降序",key:"-id"}],temp:{product_good_id:void 0,money:void 0},dialogFormVisible:!1,dialogStatus:"",textMap:{update:"编辑",create:"创建"},productGoodsOptions:[],productGoodsLoading:!1,productGoodsSkuLoading:!1,productGoodsSkuOptions:[]}},created:function(){this.getList()},filters:{statusUnit:function(n){return{0:"件",1:"斤",2:"g"}[n]}},methods:{handleSizeChange:function(n){this.listQuery.page_size=n,this.getList()},handleCurrentChange:function(n){this.listQuery.page=n,this.getList()},getProductGoodsList:function(n){var t=this;""!==n&&(this.productGoodsLoading=!0,Object(i.g)({goods_name:n,page_size:0,status:1}).then(function(n){t.productGoodsOptions=n.data,t.productGoodsLoading=!1}))},getProductGoodsSkuList:function(){var n=this;if(!this.temp.product_goods_common_id)return this.$message.error("选择商品"),!1;this.productGoodsSkuLoading=!0,Object(i.h)({product_goods_common_id:this.temp.product_goods_common_id,page_size:0}).then(function(t){n.productGoodsSkuOptions=t.data,n.productGoodsSkuLoading=!1})},handleFilter:function(){this.listQuery.page=1,this.getList()},handleFilter2:function(){this.productOptions=[],this.listQuery.product_id=void 0,this.handleFilter()},handleQueryTypeChange:function(n){this.list=[],this.handleFilter()},getList:function(){var n=this;this.listLoading=!0,Object(o.b)(this.listQuery).then(function(t){n.list=t.data.data,n.total=t.data.total,n.listLoading=!1})},handleAddCost:function(){var n=this;this.dialogFormVisible=!0,this.$nextTick(function(){n.$refs.dataForm.clearValidate()})},createCost:function(){var n=this;this.$refs.dataForm.validate(function(t){t&&Object(o.a)(n.temp).then(function(t){n.getList(),n.dialogFormVisible=!1,n.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3})})})}},watch:{dialogFormVisible:function(n){!1===n&&(this.temp={product_good_id:void 0,money:void 0})}},deactivated:function(){this.scrollTop=document.documentElement.scrollTop||document.body.scrollTop},activated:function(){this.getList(),window.scrollTo(0,this.scrollTop)}},s={render:function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("div",{staticClass:"app-container calendar-list-container"},[e("div",{staticClass:"filter-container"},[e("div",[e("el-select",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{filterable:"",clearable:"",remote:"",placeholder:"选择商品","remote-method":n.getProductGoodsList,loading:n.productGoodsLoading},on:{change:n.handleFilter},model:{value:n.listQuery.product_good_id,callback:function(t){n.$set(n.listQuery,"product_good_id",t)},expression:"listQuery.product_good_id"}},n._l(n.productGoodsOptions,function(n){return e("el-option",{key:n.id,attrs:{label:n.goods_name,value:n.id}})})),n._v(" "),e("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:n.handleFilter}},[n._v("\n                  搜索\n      ")]),n._v(" "),e("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-edit"},on:{click:n.handleAddCost}},[n._v("添加\n      ")]),n._v(" "),e("el-switch",{staticStyle:{float:"right"},attrs:{"active-value":1,"inactive-value":0,"active-text":"全部成本","inactive-text":"最新成本"},on:{change:n.handleFilter},model:{value:n.listQuery.show_terminal,callback:function(t){n.$set(n.listQuery,"show_terminal",t)},expression:"listQuery.show_terminal"}})],1)]),n._v(" "),e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:n.listLoading,expression:"listLoading"}],key:n.tableKey,staticStyle:{width:"100%"},attrs:{id:"productMember",data:n.list,"element-loading-text":"给我一点时间",border:"",fit:"","highlight-current-row":""}},[e("el-table-column",{attrs:{align:"center",label:"ID",width:"60"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("span",[n._v("\n              "+n._s(t.row.id)+"\n            ")])]}}])}),n._v(" "),e("el-table-column",{attrs:{align:"center",label:"商品","min-width":"250"},scopedSlots:n._u([{key:"default",fn:function(t){return[t.row.product_good?e("span",[n._v("\n          "+n._s(t.row.product_good.goods_name)+"\n        ")]):n._e()]}}])}),n._v(" "),e("el-table-column",{attrs:{align:"center",label:"时间","min-width":"350"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("span",[n._v(n._s(t.row.start_at))]),n._v("\n        --\n        "),null!==t.row.terminal_at?e("span",[n._v("\n          "+n._s(t.row.terminal_at)+"\n        ")]):e("span",[n._v(" 今 ")])]}}])}),n._v(" "),e("el-table-column",{attrs:{align:"center",label:"消费","min-width":"100"},scopedSlots:n._u([{key:"default",fn:function(t){return[e("span",[n._v("¥ "+n._s(t.row.money))])]}}])})],1),n._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!n.listLoading,expression:"!listLoading"}],staticClass:"pagination-container"},[e("el-pagination",{attrs:{background:"","current-page":n.listQuery.page,"page-sizes":[10,20,30,50],"page-size":n.listQuery.page_size,layout:"total, sizes, prev, pager, next, jumper",total:n.total},on:{"size-change":n.handleSizeChange,"current-change":n.handleCurrentChange,"update:currentPage":function(t){n.$set(n.listQuery,"page",t)}}})],1),n._v(" "),e("el-dialog",{attrs:{title:"成本录入",visible:n.dialogFormVisible,width:"40%"},on:{"update:visible":function(t){n.dialogFormVisible=t}}},[e("el-form",{ref:"dataForm",staticStyle:{width:"90%","margin-left":"5%"},attrs:{rules:n.rules,model:n.temp,"label-position":"left","label-width":"80px"}},[e("el-form-item",{attrs:{label:"商品",prop:"product_goods_id"}},[e("el-select",{staticStyle:{width:"100%"},attrs:{filterable:"",clearable:"",remote:"",placeholder:"商品","remote-method":n.getProductGoodsList,loading:n.productGoodsLoading},model:{value:n.temp.product_good_id,callback:function(t){n.$set(n.temp,"product_good_id",t)},expression:"temp.product_good_id"}},n._l(n.productGoodsOptions,function(n){return e("el-option",{key:n.id,attrs:{label:n.goods_name,value:n.id}})}))],1),n._v(" "),e("el-form-item",{attrs:{label:"成本",prop:"money"}},[e("el-input-number",{model:{value:n.temp.money,callback:function(t){n.$set(n.temp,"money",t)},expression:"temp.money"}})],1)],1),n._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(t){n.dialogFormVisible=!1}}},[n._v("取 消")]),n._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:n.createCost}},[n._v("确 定")])],1)],1)],1)},staticRenderFns:[]},l=e("VU/8")(a,s,!1,function(n){e("7ABA")},"data-v-54e752e8",null);t.default=l.exports},"7ABA":function(n,t,e){var o=e("hCtO");"string"==typeof o&&(o=[[n.i,o,""]]),o.locals&&(n.exports=o.locals);e("rjj0")("848ee204",o,!0)},hCtO:function(n,t,e){(n.exports=e("FZ+f")(!1)).push([n.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])}});